<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Progress Report Generator - RillCod Technologies</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --navy-blue: #000080;
            --maroon: #800000;
            --light-maroon: #ffebee;
            --light-navy: #e8eaf6;
            --section-padding: 12px;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            line-height: 1.5;
        }
        .container {
            display: flex;
            min-height: 100vh;
        }
        .settings-panel {
            width: 280px;
            background-color: white;
            padding: 15px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
        }
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        .page {
            width: 210mm;
            height: 297mm;
            margin: 0 auto;
            background: white;
            padding: 10mm 15mm 5mm 15mm;
            position: relative;
            box-sizing: border-box;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 3mm;
            padding-bottom: 2mm;
            border-bottom: 1.5px solid var(--maroon);
        }
        .header-content {
            text-align: center;
        }
        .logo {
            height: 20mm;
            width: auto;
            margin-bottom: 1mm;
        }
        .company-name {
            font-size: 18pt;
            font-weight: bold;
            color: var(--navy-blue);
            margin: 0;
            line-height: 1.2;
        }
        .tagline {
            font-style: italic;
            color: var(--maroon);
            margin: 1mm 0 0;
            font-size: 10pt;
        }
        .contact-info {
            font-size: 8pt;
            color: var(--navy-blue);
            margin-top: 1mm;
        }
        .report-title {
            text-align: center;
            font-size: 16pt;
            font-weight: bold;
            margin: 2mm 0 3mm;
            color: var(--maroon);
        }
        .student-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2mm;
            margin-bottom: 3mm;
            background-color: var(--light-navy);
            padding: 3mm;
            border-radius: 2mm;
            font-size: 10pt;
        }
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3mm;
            margin-top: 2mm;
        }
        .section {
            margin-bottom: 4mm;
        }
        .section-title {
            font-size: 12pt;
            font-weight: bold;
            color: var(--navy-blue);
            margin: 0 0 2mm;
            padding-bottom: 1mm;
            border-bottom: 1px solid var(--maroon);
        }
        .progress-list {
            list-style-type: none;
            padding-left: 0;
            margin: 1mm 0;
            font-size: 10pt;
        }
        .progress-list li {
            margin-bottom: 2mm;
            position: relative;
            padding-left: 3mm;
        }
        .progress-list li:before {
            content: "•";
            color: var(--maroon);
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        .assessment-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1mm 0;
            font-size: 10pt;
        }
        .assessment-table th, .assessment-table td {
            border: 1px solid #ddd;
            padding: 2mm;
            text-align: left;
        }
        .assessment-table th {
            background-color: var(--navy-blue);
            color: white;
            font-size: 10pt;
        }
        .comments {
            background-color: var(--light-maroon);
            padding: 3mm;
            border-radius: 2mm;
            font-size: 10pt;
            margin: 1mm 0;
        }
        .chart-container {
            height: 60mm;
            margin: 2mm 0;
            position: relative;
        }
        .certificate {
            text-align: center;
            margin-top: 3mm;
            padding: 3mm;
            border: 1px solid var(--maroon);
            border-radius: 2mm;
            font-size: 10pt;
        }
        .signature {
            display: flex;
            justify-content: space-between;
            margin-top: 5mm;
        }
        .signature-line {
            border-top: 1px solid var(--navy-blue);
            width: 50mm;
            margin-top: 10mm;
        }
        .form-container {
            background-color: white;
            padding: 15px;
            border-radius: 2mm;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 12px;
        }
        label {
            display: block;
            margin-bottom: 3px;
            font-weight: bold;
            color: var(--navy-blue);
            font-size: 11pt;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 1mm;
            box-sizing: border-box;
            font-size: 11pt;
        }
        textarea {
            min-height: 60px;
            resize: vertical;
        }
        .submit-btn {
            background-color: var(--maroon);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 1mm;
            cursor: pointer;
            font-size: 11pt;
            width: 100%;
            margin-top: 10px;
            font-weight: bold;
        }
        footer {
            text-align: center;
            font-size: 8pt;
            color: var(--navy-blue);
            margin-top: 3mm;
            position: absolute;
            bottom: 2mm;
            left: 0;
            right: 0;
            padding: 0 15mm;
        }
        strong {
            color: var(--navy-blue);
        }
        .total-performance {
            background-color: var(--light-navy);
            padding: 3mm;
            border-radius: 2mm;
            margin-top: 2mm;
            font-size: 10pt;
        }
        .performance-grade {
            font-size: 14pt;
            font-weight: bold;
            color: var(--maroon);
            text-align: center;
            margin-top: 2mm;
        }
        .payment-info {
            margin-top: 3mm;
            font-size: 10pt;
            text-align: center;
            font-weight: bold;
        }
        .form-section-title {
            font-size: 14pt;
            font-weight: bold;
            color: var(--navy-blue);
            margin: 10px 0 5px;
            padding-bottom: 3px;
            border-bottom: 1px solid var(--maroon);
        }
        .form-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .add-item-btn {
            background-color: var(--navy-blue);
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 1mm;
            cursor: pointer;
            font-size: 10pt;
            margin-top: 5px;
        }
        .progress-item {
            display: flex;
            gap: 5px;
            margin-bottom: 5px;
        }
        .progress-item input {
            flex-grow: 1;
        }
        .remove-item-btn {
            background-color: #ff4444;
            color: white;
            border: none;
            border-radius: 1mm;
            cursor: pointer;
            width: 30px;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        .suggest-btn {
            background-color: var(--navy-blue);
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 1mm;
            cursor: pointer;
            font-size: 10pt;
            margin-top: 5px;
        }
        .pregen-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-top: 5px;
        }
        .pregen-option {
            background-color: #f0f0f0;
            padding: 6px;
            border-radius: 1mm;
            cursor: pointer;
            font-size: 10pt;
            border: 1px solid #ddd;
        }
        .pregen-option:hover {
            background-color: #e0e0e0;
        }
        .ai-generate-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 1mm;
            cursor: pointer;
            font-size: 10pt;
            margin-top: 5px;
        }
        .loading {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-left: 5px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .settings-section {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .settings-title {
            font-size: 14px;
            font-weight: bold;
            color: var(--navy-blue);
            margin-bottom: 10px;
        }
        .save-settings-btn {
            background-color: var(--maroon);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 1mm;
            cursor: pointer;
            font-size: 11pt;
            width: 100%;
            margin-top: 10px;
        }
        .batch-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .batch-btn {
            flex: 1;
            padding: 8px;
            border-radius: 1mm;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        .print-all-btn {
            background-color: var(--navy-blue);
            color: white;
        }
        .clear-all-btn {
            background-color: #ff4444;
            color: white;
        }
        .saved-reports {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 1mm;
            padding: 5px;
        }
        .saved-report {
            padding: 5px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        .saved-report.selected {
            background-color: var(--light-navy);
        }
        .saved-report:last-child {
            border-bottom: none;
        }
        .tab-container {
            display: flex;
            margin-bottom: 15px;
        }
        .tab {
            padding: 8px 15px;
            cursor: pointer;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 3px 3px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background-color: white;
            border-bottom: 1px solid white;
            margin-bottom: -1px;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-footer {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .form-footer button {
            flex: 1;
        }
        .clear-form-btn {
            background-color: #666;
            color: white;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        .checkbox-group input {
            width: auto;
            margin-right: 8px;
        }
        .progress-presets {
            margin-top: 10px;
        }
        .progress-preset-btn {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 5px 10px;
            margin-right: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            font-size: 10pt;
        }
        .progress-preset-btn:hover {
            background-color: #e0e0e0;
        }
        .module-selector {
            margin-top: 10px;
        }
        .module-option {
            display: inline-block;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        .module-checkbox {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="settings-panel">
            <div class="settings-section">
                <div class="settings-title">Report Settings</div>
                <div class="form-group">
                    <label for="settings-courseName">Course Name:</label>
                    <input type="text" id="settings-courseName" value="Python Programming Fundamentals">
                </div>
                <div class="form-group">
                    <label for="settings-currentModule">Current Module:</label>
                    <input type="text" id="settings-currentModule" value="Variables to Conditionals">
                </div>
                <div class="form-group">
                    <label for="settings-nextModule">Next Module:</label>
                    <input type="text" id="settings-nextModule" value="Loops (while/for) and Functions">
                </div>
                <div class="form-group">
                    <label for="settings-instructorName">Instructor Name:</label>
                    <input type="text" id="settings-instructorName" value="RillCod Technologies">
                </div>
                <div class="form-group">
                    <label for="settings-duration">Duration:</label>
                    <input type="text" id="settings-duration" value="Termly">
                </div>
                <div class="form-group">
                    <label for="settings-nextTermFee">Next Term Fee:</label>
                    <input type="text" id="settings-nextTermFee" value="₦15,000">
                </div>
                <div class="form-group">
                    <label for="settings-bankDetails">Bank Details:</label>
                    <input type="text" id="settings-bankDetails" value="PROVIDUS | ACCOUNT NUMBER: 7901178957">
                </div>
                
                <div class="form-section-title">Course Progress Presets</div>
                <div class="module-selector">
                    <div class="module-option">
                        <input type="checkbox" id="preset-python" class="module-checkbox" checked>
                        <label for="preset-python">Python</label>
                    </div>
                    <div class="module-option">
                        <input type="checkbox" id="preset-javascript" class="module-checkbox">
                        <label for="preset-javascript">JavaScript</label>
                    </div>
                    <div class="module-option">
                        <input type="checkbox" id="preset-html" class="module-checkbox">
                        <label for="preset-html">HTML</label>
                    </div>
                    <div class="module-option">
                        <input type="checkbox" id="preset-css" class="module-checkbox">
                        <label for="preset-css">CSS</label>
                    </div>
                    <div class="module-option">
                        <input type="checkbox" id="preset-java" class="module-checkbox">
                        <label for="preset-java">Java</label>
                    </div>
                    <div class="module-option">
                        <input type="checkbox" id="preset-csharp" class="module-checkbox">
                        <label for="preset-csharp">C#</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="moduleTopics">Module Topics (comma separated):</label>
                    <input type="text" id="moduleTopics" placeholder="e.g., Variables, Data Types, Conditionals">
                    <button type="button" class="ai-generate-btn" id="generateProgressBtn">Generate Progress Items</button>
                </div>
                
                <div class="progress-presets">
                    <button type="button" class="progress-preset-btn" data-preset="python">Python Basics</button>
                    <button type="button" class="progress-preset-btn" data-preset="web">Web Development</button>
                    <button type="button" class="progress-preset-btn" data-preset="oop">OOP Concepts</button>
                </div>
                
                <button class="save-settings-btn" id="saveSettingsBtn">Save Settings</button>
            </div>
            
            <div class="settings-section">
                <div class="settings-title">Batch Reports</div>
                <div class="batch-controls">
                    <button class="batch-btn print-all-btn" id="printAllBtn">Print Selected</button>
                    <button class="batch-btn clear-all-btn" id="clearAllBtn">Clear All</button>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="combinePdfCheckbox" checked>
                    <label for="combinePdfCheckbox">Combine into single PDF</label>
                </div>
                <div class="saved-reports" id="savedReportsList">
                    <!-- Saved reports will appear here -->
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="tab-container">
                <div class="tab active" data-tab="single">Single Report</div>
                <div class="tab" data-tab="batch">Batch Entry</div>
            </div>
            
            <div class="tab-content active" id="single-tab">
                <div class="form-container">
                    <form id="scoreForm">
                        <div class="form-section-title">Student Information</div>
                        <div class="form-columns">
                            <div class="form-group">
                                <label for="studentName">Student Full Name:</label>
                                <input type="text" id="studentName" name="studentName" required>
                            </div>
                            <div class="form-group">
                                <label for="reportDate">Report Date:</label>
                                <input type="date" id="reportDate" name="reportDate" required>
                            </div>
                        </div>
                        
                        <div class="form-section-title">Performance Assessment</div>
                        <div class="form-columns">
                            <div class="form-group">
                                <label for="theoryScore">Theory Test Score (0-100):</label>
                                <input type="number" id="theoryScore" name="theoryScore" min="0" max="100" required>
                            </div>
                            <div class="form-group">
                                <label for="practicalScore">Practical Test Score (0-100):</label>
                                <input type="number" id="practicalScore" name="practicalScore" min="0" max="100" required>
                            </div>
                        </div>
                        
                        <div class="form-columns">
                            <div class="form-group">
                                <label for="attendance">Attendance Percentage (0-100):</label>
                                <input type="number" id="attendance" name="attendance" min="0" max="100" value="100" required>
                            </div>
                            <div class="form-group">
                                <label for="participation">Class Participation:</label>
                                <select id="participation" name="participation" required>
                                    <option value="">Select an option</option>
                                    <option value="Excellent">Excellent</option>
                                    <option value="Very Good">Very Good</option>
                                    <option value="Good">Good</option>
                                    <option value="Fair">Fair</option>
                                    <option value="Needs Improvement">Needs Improvement</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-section-title">Course Progress</div>
                        <div id="progressItems">
                            <div class="progress-item">
                                <input type="text" name="progressItem[]" placeholder="Progress item (e.g., Variables & Data Types)" required>
                                <button type="button" class="remove-item-btn" onclick="removeProgressItem(this)">×</button>
                            </div>
                        </div>
                        <button type="button" class="add-item-btn" onclick="addProgressItem()">Add Progress Item</button>
                        
                        <div class="form-section-title">Evaluation</div>
                        <div class="form-group">
                            <label for="strengths">Key Strengths:</label>
                            <textarea id="strengths" name="strengths" required></textarea>
                            <button type="button" class="suggest-btn" onclick="showStrengthOptions()">Suggest Strengths</button>
                            <div id="strengthOptions" class="hidden pregen-options">
                                <div class="pregen-option" onclick="selectStrength('Excellent problem-solving skills')">Excellent problem-solving skills</div>
                                <div class="pregen-option" onclick="selectStrength('Quick grasp of programming concepts')">Quick grasp of concepts</div>
                                <div class="pregen-option" onclick="selectStrength('Strong logical thinking abilities')">Strong logical thinking</div>
                                <div class="pregen-option" onclick="selectStrength('Excellent attention to detail')">Attention to detail</div>
                                <div class="pregen-option" onclick="selectStrength('Creative approach to coding challenges')">Creative approach</div>
                                <div class="pregen-option" onclick="selectStrength('Good collaborative skills')">Collaborative skills</div>
                                <div class="pregen-option" onclick="selectStrength('Persistent in debugging code')">Persistent debugging</div>
                                <div class="pregen-option" onclick="selectStrength('Excellent code organization')">Code organization</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="growth">Areas for Growth:</label>
                            <textarea id="growth" name="growth" required></textarea>
                            <button type="button" class="suggest-btn" onclick="showGrowthOptions()">Suggest Areas for Growth</button>
                            <div id="growthOptions" class="hidden pregen-options">
                                <div class="pregen-option" onclick="selectGrowth('Could benefit from more practice with syntax')">Syntax practice</div>
                                <div class="pregen-option" onclick="selectGrowth('Needs to work on code commenting')">Code commenting</div>
                                <div class="pregen-option" onclick="selectGrowth('Should focus on variable naming conventions')">Variable naming</div>
                                <div class="pregen-option" onclick="selectGrowth('Would benefit from more pseudocode planning')">Pseudocode planning</div>
                                <div class="pregen-option" onclick="selectGrowth('Needs to improve error handling')">Error handling</div>
                                <div class="pregen-option" onclick="selectGrowth('Could work on program efficiency')">Program efficiency</div>
                                <div class="pregen-option" onclick="selectGrowth('Should practice more independent problem-solving')">Independent problem-solving</div>
                                <div class="pregen-option" onclick="selectGrowth('Needs to work on time management')">Time management</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="comments">Overall Comments:</label>
                            <textarea id="comments" name="comments" required></textarea>
                            <button type="button" class="suggest-btn" onclick="showCommentOptions()">Suggest Comments</button>
                            <div id="commentOptions" class="hidden pregen-options">
                                <div class="pregen-option" onclick="selectComment('[Student] has shown remarkable progress in understanding Python fundamentals. With continued practice, [they] will master more advanced concepts quickly.')">Remarkable progress</div>
                                <div class="pregen-option" onclick="selectComment('[Student] demonstrates good understanding of core concepts. Focusing on [their] areas for growth will help [them] become a more well-rounded programmer.')">Good understanding</div>
                                <div class="pregen-option" onclick="selectComment('[Student] is developing solid programming skills. I encourage [them] to practice daily to reinforce the concepts we\'ve covered.')">Developing skills</div>
                                <div class="pregen-option" onclick="selectComment('[Student] shows potential in programming. With more attention to detail and regular practice, [they] will see significant improvement.')">Shows potential</div>
                                <div class="pregen-option" onclick="selectComment('[Student] has made steady progress this term. I recommend targeted practice in [their] weaker areas to build confidence.')">Steady progress</div>
                                <div class="pregen-option" onclick="selectComment('[Student] is beginning to apply concepts effectively. Continued exposure to different problem types will help [them] grow.')">Applying concepts</div>
                                <div class="pregen-option" onclick="selectComment('[Student] participates well in class. Focusing on [their] areas for improvement will help [them] excel in upcoming modules.')">Participates well</div>
                                <div class="pregen-option" onclick="selectComment('[Student] has a good foundation. I encourage [them] to challenge [themselves] with additional practice problems between sessions.')">Good foundation</div>
                            </div>
                        </div>
                        
                        <div class="form-section-title">Certificate Information</div>
                        <div class="form-group">
                            <label for="certificateText">Certificate Text:</label>
                            <textarea id="certificateText" name="certificateText" required>This certifies that [Student Name] has successfully completed the [Course Module] module covering [Module Topics] at Rillcod Technologies.</textarea>
                        </div>
                        
                        <div class="form-footer">
                            <button type="submit" class="submit-btn">Generate PDF Report</button>
                            <button type="button" class="submit-btn" id="saveForBatchBtn" style="background-color: var(--navy-blue);">Save for Batch</button>
                            <button type="button" class="clear-form-btn" id="clearFormBtn">Clear Form</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="tab-content" id="batch-tab">
                <div class="form-container">
                    <div class="form-section-title">Batch Student Entry</div>
                    <div class="form-group">
                        <label for="batchStudentNames">Student Names (one per line):</label>
                        <textarea id="batchStudentNames" placeholder="Enter student names, one per line"></textarea>
                    </div>
                    
                    <div class="form-section-title">Performance Assessment</div>
                    <div class="form-columns">
                        <div class="form-group">
                            <label for="batchTheoryScore">Theory Test Score (0-100):</label>
                            <input type="number" id="batchTheoryScore" min="0" max="100">
                        </div>
                        <div class="form-group">
                            <label for="batchPracticalScore">Practical Test Score (0-100):</label>
                            <input type="number" id="batchPracticalScore" min="0" max="100">
                        </div>
                    </div>
                    
                    <div class="form-columns">
                        <div class="form-group">
                            <label for="batchAttendance">Attendance Percentage (0-100):</label>
                            <input type="number" id="batchAttendance" min="0" max="100" value="100">
                        </div>
                        <div class="form-group">
                            <label for="batchParticipation">Class Participation:</label>
                            <select id="batchParticipation">
                                <option value="">Select an option</option>
                                <option value="Excellent">Excellent</option>
                                <option value="Very Good">Very Good</option>
                                <option value="Good">Good</option>
                                <option value="Fair">Fair</option>
                                <option value="Needs Improvement">Needs Improvement</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-section-title">Evaluation</div>
                    <div class="form-group">
                        <label for="batchStrengths">Key Strengths:</label>
                        <textarea id="batchStrengths"></textarea>
                        <button type="button" class="suggest-btn" onclick="showBatchStrengthOptions()">Suggest Strengths</button>
                        <div id="batchStrengthOptions" class="hidden pregen-options">
                            <div class="pregen-option" onclick="selectBatchStrength('Excellent problem-solving skills')">Excellent problem-solving skills</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Quick grasp of programming concepts')">Quick grasp of concepts</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Strong logical thinking abilities')">Strong logical thinking</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Excellent attention to detail')">Attention to detail</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Creative approach to coding challenges')">Creative approach</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Good collaborative skills')">Collaborative skills</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Persistent in debugging code')">Persistent debugging</div>
                            <div class="pregen-option" onclick="selectBatchStrength('Excellent code organization')">Code organization</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="batchGrowth">Areas for Growth:</label>
                        <textarea id="batchGrowth"></textarea>
                        <button type="button" class="suggest-btn" onclick="showBatchGrowthOptions()">Suggest Areas for Growth</button>
                        <div id="batchGrowthOptions" class="hidden pregen-options">
                            <div class="pregen-option" onclick="selectBatchGrowth('Could benefit from more practice with syntax')">Syntax practice</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Needs to work on code commenting')">Code commenting</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Should focus on variable naming conventions')">Variable naming</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Would benefit from more pseudocode planning')">Pseudocode planning</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Needs to improve error handling')">Error handling</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Could work on program efficiency')">Program efficiency</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Should practice more independent problem-solving')">Independent problem-solving</div>
                            <div class="pregen-option" onclick="selectBatchGrowth('Needs to work on time management')">Time management</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="batchComments">Overall Comments:</label>
                        <textarea id="batchComments"></textarea>
                        <button type="button" class="suggest-btn" onclick="showBatchCommentOptions()">Suggest Comments</button>
                        <div id="batchCommentOptions" class="hidden pregen-options">
                            <div class="pregen-option" onclick="selectBatchComment('[Student] has shown remarkable progress in understanding Python fundamentals. With continued practice, [they] will master more advanced concepts quickly.')">Remarkable progress</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] demonstrates good understanding of core concepts. Focusing on [their] areas for growth will help [them] become a more well-rounded programmer.')">Good understanding</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] is developing solid programming skills. I encourage [them] to practice daily to reinforce the concepts we\'ve covered.')">Developing skills</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] shows potential in programming. With more attention to detail and regular practice, [they] will see significant improvement.')">Shows potential</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] has made steady progress this term. I recommend targeted practice in [their] weaker areas to build confidence.')">Steady progress</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] is beginning to apply concepts effectively. Continued exposure to different problem types will help [them] grow.')">Applying concepts</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] participates well in class. Focusing on [their] areas for improvement will help [them] excel in upcoming modules.')">Participates well</div>
                            <div class="pregen-option" onclick="selectBatchComment('[Student] has a good foundation. I encourage [them] to challenge [themselves] with additional practice problems between sessions.')">Good foundation</div>
                        </div>
                    </div>
                    
                    <div class="form-section-title">Course Progress</div>
                    <div id="batchProgressItems">
                        <div class="progress-item">
                            <input type="text" name="batchProgressItem[]" placeholder="Progress item (e.g., Variables & Data Types)">
                            <button type="button" class="remove-item-btn" onclick="removeBatchProgressItem(this)">×</button>
                        </div>
                    </div>
                    <button type="button" class="add-item-btn" onclick="addBatchProgressItem()">Add Progress Item</button>
                    
                    <button type="button" class="submit-btn" id="generateBatchBtn">Generate Reports for All Students</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="reportContent" class="page hidden">
        <div class="header">
            <div class="header-content">
                <img src="https://res.cloudinary.com/dpigtwit0/image/upload/c_thumb,w_200,g_face/v1744353437/Logo_03_PNG_y3jntf.png" alt="RillCod Logo" class="logo">
                <div class="company-name">RILLCOD TECHNOLOGIES</div>
                <div class="tagline">Coding Today, Innovating Tomorrow</div>
                <div class="contact-info">
                    📍 26 Ogiesoba Avenue, Off Airport Road, GRA, Benin City • 📞 08116600091 • ✉ rillcod@gmail.com • 🌐 www.rillcod.com
                </div>
            </div>
        </div>

        <div class="report-title">STUDENT PROGRESS REPORT</div>
        
        <div class="student-info">
            <div><strong>Student Name:</strong> <span id="reportStudentName">[Full Name]</span></div>
            <div><strong>Course:</strong> <span id="reportCourseName">[Course Name]</span></div>
            <div><strong>Current Module:</strong> <span id="reportCurrentModule">[Current Module]</span></div>
            <div><strong>Report Date:</strong> <span id="reportDateDisplay">[Date]</span></div>
            <div><strong>Instructor:</strong> <span id="reportInstructor">[Instructor]</span></div>
            <div><strong>Duration:</strong> <span id="reportDuration">[Duration]</span></div>
        </div>

        <div class="grid-container">
            <div>
                <div class="section">
                    <div class="section-title">COURSE PROGRESS</div>
                    <ul class="progress-list" id="reportProgressItems">
                        <!-- Progress items will be added here -->
                    </ul>
                    <div style="font-style: italic; margin-top: 1mm;"><strong>Next Module:</strong> <span id="reportNextModule">[Next Module]</span></div>
                </div>

                <div class="section">
                    <div class="section-title">PERFORMANCE ASSESSMENT</div>
                    <table class="assessment-table">
                        <tr>
                            <th>Assessment</th>
                            <th>Score</th>
                            <th>Grade</th>
                        </tr>
                        <tr>
                            <td>Theory Test</td>
                            <td id="theoryScoreDisplay">[XX]</td>
                            <td id="theoryGradeDisplay">[A-F]</td>
                        </tr>
                        <tr>
                            <td>Practical Test</td>
                            <td id="practicalScoreDisplay">[XX]</td>
                            <td id="practicalGradeDisplay">[A-F]</td>
                        </tr>
                        <tr>
                            <td>Attendance</td>
                            <td id="attendanceDisplay">[XX]%</td>
                            <td id="attendanceGradeDisplay">[A-F]</td>
                        </tr>
                        <tr>
                            <td>Participation</td>
                            <td id="participationDisplay" colspan="2">[Rating]</td>
                        </tr>
                    </table>
                    
                    <div class="total-performance">
                        <div><strong>Overall Performance:</strong></div>
                        <div class="performance-grade" id="overallGradeDisplay">[A-F]</div>
                    </div>
                </div>
            </div>

            <div>
                <div class="section">
                    <div class="section-title">PERFORMANCE CHART</div>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">INSTRUCTOR'S EVALUATION</div>
                    <div class="comments" id="instructorComments">
                        [Student] has shown [progress] in understanding Python fundamentals...
                    </div>
                    <div style="margin-top: 2mm;">
                        <div><strong>✅ Key Strengths:</strong></div>
                        <div id="strengthsDisplay" style="margin-left: 2mm;">[Student strengths]</div>
                    </div>
                    <div style="margin-top: 2mm;">
                        <div><strong>📈 Areas for Growth:</strong></div>
                        <div id="growthDisplay" style="margin-left: 2mm;">[Improvement areas]</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title" style="text-align: center;">CERTIFICATE OF COMPLETION</div>
            <div class="certificate">
                <p id="certificateTextDisplay">[Certificate text]</p>
                <div class="payment-info">
                    NEXT TERM FEE PAYMENT IS <span id="nextTermFeeDisplay">[Fee]</span> TO RILLCOD LTD.<br>
                    BANK: <span id="bankDetailsDisplay">[Bank details]</span>
                </div>
                <div class="signature">
                    <div>
                        <div class="signature-line"></div>
                        <p>Instructor's Signature</p>
                    </div>
                    <div>
                        <div class="signature-line"></div>
                        <p>Date</p>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            © <span id="currentYear"></span> Rillcod Technologies | All Rights Reserved | Report generated on <span id="footerDate"></span>
        </footer>
    </div>

    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        
        // Initialize chart variable
        let performanceChart;
        const ctx = document.getElementById('performanceChart').getContext('2d');
        
        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        // Set default date to today
        document.getElementById('reportDate').valueAsDate = new Date();
        
        // Initialize settings from localStorage or defaults
        let appSettings = JSON.parse(localStorage.getItem('rillcodReportSettings')) || {
            courseName: "Python Programming Fundamentals",
            currentModule: "Variables to Conditionals",
            nextModule: "Loops (while/for) and Functions",
            instructorName: "RillCod Technologies",
            duration: "Termly",
            nextTermFee: "₦15,000",
            bankDetails: "PROVIDUS | ACCOUNT NUMBER: 7901178957",
            progressItems: []
        };
        
        // Initialize saved reports
        let savedReports = JSON.parse(localStorage.getItem('rillcodSavedReports')) || [];
        
        // Track selected reports for batch printing
        let selectedReports = [];
        
        // Load settings into form
        function loadSettings() {
            document.getElementById('settings-courseName').value = appSettings.courseName;
            document.getElementById('settings-currentModule').value = appSettings.currentModule;
            document.getElementById('settings-nextModule').value = appSettings.nextModule;
            document.getElementById('settings-instructorName').value = appSettings.instructorName;
            document.getElementById('settings-duration').value = appSettings.duration;
            document.getElementById('settings-nextTermFee').value = appSettings.nextTermFee;
            document.getElementById('settings-bankDetails').value = appSettings.bankDetails;
            
            updateSavedReportsList();
        }
        
        // Save settings
        document.getElementById('saveSettingsBtn').addEventListener('click', function() {
            appSettings = {
                courseName: document.getElementById('settings-courseName').value,
                currentModule: document.getElementById('settings-currentModule').value,
                nextModule: document.getElementById('settings-nextModule').value,
                instructorName: document.getElementById('settings-instructorName').value,
                duration: document.getElementById('settings-duration').value,
                nextTermFee: document.getElementById('settings-nextTermFee').value,
                bankDetails: document.getElementById('settings-bankDetails').value,
                progressItems: appSettings.progressItems
            };
            
            localStorage.setItem('rillcodReportSettings', JSON.stringify(appSettings));
            alert('Settings saved successfully!');
        });
        
        // Clear form
        document.getElementById('clearFormBtn').addEventListener('click', function() {
            if (confirm('Clear all form fields?')) {
                document.getElementById('scoreForm').reset();
                document.getElementById('reportDate').valueAsDate = new Date();
                
                // Clear progress items except first one
                const progressItems = document.querySelectorAll('#progressItems .progress-item');
                for (let i = 1; i < progressItems.length; i++) {
                    progressItems[i].remove();
                }
                
                // Reset first progress item
                const firstInput = document.querySelector('#progressItems .progress-item input');
                if (firstInput) {
                    firstInput.value = '';
                }
                
                // Hide all suggestion panels
                document.getElementById('strengthOptions').classList.add('hidden');
                document.getElementById('growthOptions').classList.add('hidden');
                document.getElementById('commentOptions').classList.add('hidden');
            }
        });
        
        // Save report for batch printing
        document.getElementById('saveForBatchBtn').addEventListener('click', function() {
            const formData = new FormData(document.getElementById('scoreForm'));
            const data = Object.fromEntries(formData.entries());
            
            // Get all progress items
            data.progressItems = Array.from(document.querySelectorAll('[name="progressItem[]"]')).map(input => input.value);
            
            // Add to saved reports
            savedReports.push(data);
            localStorage.setItem('rillcodSavedReports', JSON.stringify(savedReports));
            
            updateSavedReportsList();
            alert('Report saved for batch printing!');
            
            // Clear the form after saving
            document.getElementById('clearFormBtn').click();
        });
        
        // Print selected reports
        document.getElementById('printAllBtn').addEventListener('click', function() {
            if (selectedReports.length === 0) {
                alert('No reports selected for printing.');
                return;
            }
            
            const combinePdf = document.getElementById('combinePdfCheckbox').checked;
            
            if (combinePdf) {
                if (confirm(`Combine and print ${selectedReports.length} selected reports into one PDF?`)) {
                    combineSelectedReportsIntoPdf();
                }
            } else {
                if (confirm(`Print ${selectedReports.length} individual PDFs for selected reports?`)) {
                    printSelectedReportsSequentially(0);
                }
            }
        });
        
        // Combine selected reports into one PDF
        async function combineSelectedReportsIntoPdf() {
            const pdf = new jsPDF('p', 'mm', 'a4');
            let positionY = 0;
            let firstPage = true;
            
            for (let i = 0; i < selectedReports.length; i++) {
                const reportData = selectedReports[i];
                await generateReportCanvas(reportData, async (canvas) => {
                    const imgData = canvas.toDataURL('image/png', 1.0);
                    const imgWidth = pdf.internal.pageSize.getWidth() - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    if (!firstPage && positionY + imgHeight > pdf.internal.pageSize.getHeight() - 20) {
                        pdf.addPage();
                        positionY = 0;
                    }
                    
                    const x = (pdf.internal.pageSize.getWidth() - imgWidth) / 2;
                    
                    pdf.addImage(imgData, 'PNG', x, positionY, imgWidth, imgHeight);
                    positionY += imgHeight + 10;
                    
                    if (i < selectedReports.length - 1) {
                        pdf.addPage();
                        positionY = 0;
                    }
                    
                    firstPage = false;
                });
            }
            
            // Save the combined PDF
            pdf.save(`RillCod_Combined_Progress_Reports_${new Date().toISOString().slice(0,10)}.pdf`);
        }
        
        // Print selected reports one by one
        function printSelectedReportsSequentially(index) {
            if (index >= selectedReports.length) {
                alert('All selected reports printed successfully!');
                return;
            }
            
            const reportData = selectedReports[index];
            generateReportPDF(reportData, () => {
                printSelectedReportsSequentially(index + 1);
            });
        }
        
        // Generate canvas for a report
        function generateReportCanvas(data, callback) {
            return new Promise((resolve) => {
                // Format date
                const reportDate = data.reportDate ? new Date(data.reportDate) : new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                const formattedDate = reportDate.toLocaleDateString('en-US', options);
                
                // Calculate grades
                const theoryScore = parseInt(data.theoryScore) || 0;
                const practicalScore = parseInt(data.practicalScore) || 0;
                const attendance = parseInt(data.attendance) || 0;
                
                const theoryGrade = calculateGrade(theoryScore);
                const practicalGrade = calculateGrade(practicalScore);
                const attendanceGrade = calculateGrade(attendance);
                const overallGrade = calculateGrade((theoryScore + practicalScore + attendance) / 3);
                
                // Update the report
                document.getElementById('reportStudentName').textContent = data.studentName || '[Full Name]';
                document.getElementById('reportCourseName').textContent = appSettings.courseName;
                document.getElementById('reportCurrentModule').textContent = appSettings.currentModule;
                document.getElementById('reportDateDisplay').textContent = formattedDate;
                document.getElementById('footerDate').textContent = formattedDate;
                document.getElementById('reportInstructor').textContent = appSettings.instructorName;
                document.getElementById('reportDuration').textContent = appSettings.duration;
                
                // Update progress items
                const progressList = document.getElementById('reportProgressItems');
                progressList.innerHTML = '';
                (data.progressItems || ['No progress items entered']).forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${item.split(':')[0]}:</strong> ${item.split(':')[1] || ''}`;
                    progressList.appendChild(li);
                });
                
                document.getElementById('reportNextModule').textContent = appSettings.nextModule;
                
                // Update assessment
                document.getElementById('theoryScoreDisplay').textContent = theoryScore;
                document.getElementById('theoryGradeDisplay').textContent = theoryGrade;
                document.getElementById('practicalScoreDisplay').textContent = practicalScore;
                document.getElementById('practicalGradeDisplay').textContent = practicalGrade;
                document.getElementById('attendanceDisplay').textContent = attendance + '%';
                document.getElementById('attendanceGradeDisplay').textContent = attendanceGrade;
                document.getElementById('overallGradeDisplay').textContent = overallGrade;
                document.getElementById('participationDisplay').textContent = data.participation || 'Not specified';
                
                // Update evaluation
                const processedComments = (data.comments || '').replace(/\[Student\]/g, data.studentName)
                                                     .replace(/\[they\]/g, data.studentName)
                                                     .replace(/\[them\]/g, data.studentName)
                                                     .replace(/\[their\]/g, data.studentName + "'s");
                
                document.getElementById('instructorComments').textContent = processedComments || 'No comments provided.';
                document.getElementById('strengthsDisplay').textContent = data.strengths || 'No strengths specified.';
                document.getElementById('growthDisplay').textContent = data.growth || 'No areas for growth specified.';
                
                // Update certificate
                const processedCertText = (data.certificateText || '').replace(/\[Student Name\]/g, data.studentName)
                                                             .replace(/\[Course Module\]/g, appSettings.currentModule)
                                                             .replace(/\[Module Topics\]/g, appSettings.currentModule);
                
                document.getElementById('certificateTextDisplay').innerHTML = processedCertText || 'No certificate text provided.';
                document.getElementById('nextTermFeeDisplay').textContent = appSettings.nextTermFee;
                document.getElementById('bankDetailsDisplay').textContent = appSettings.bankDetails;
                
                // Update or create chart
                updateChart(theoryScore, practicalScore, attendance);
                
                // Show the report and generate canvas after a short delay to allow chart to render
                document.getElementById('reportContent').classList.remove('hidden');
                setTimeout(() => {
                    html2canvas(document.getElementById('reportContent'), {
                        scale: 2,
                        logging: false,
                        useCORS: true,
                        allowTaint: true,
                        windowWidth: document.getElementById('reportContent').scrollWidth,
                        windowHeight: document.getElementById('reportContent').scrollHeight,
                        scrollX: 0,
                        scrollY: 0,
                        backgroundColor: '#FFFFFF'
                    }).then(canvas => {
                        document.getElementById('reportContent').classList.add('hidden');
                        callback(canvas);
                        resolve();
                    });
                }, 1000);
            });
        }
        
        // Clear all saved reports
        document.getElementById('clearAllBtn').addEventListener('click', function() {
            if (savedReports.length === 0) {
                alert('No reports to clear.');
                return;
            }
            
            if (confirm('Clear all saved reports?')) {
                savedReports = [];
                selectedReports = [];
                localStorage.setItem('rillcodSavedReports', JSON.stringify(savedReports));
                updateSavedReportsList();
            }
        });
        
        // Generate reports for batch entry
        document.getElementById('generateBatchBtn').addEventListener('click', function() {
            const studentNames = document.getElementById('batchStudentNames').value.split('\n').filter(name => name.trim() !== '');
            
            if (studentNames.length === 0) {
                alert('Please enter at least one student name.');
                return;
            }
            
            const commonData = {
                reportDate: document.getElementById('reportDate').value,
                theoryScore: document.getElementById('batchTheoryScore').value,
                practicalScore: document.getElementById('batchPracticalScore').value,
                attendance: document.getElementById('batchAttendance').value,
                participation: document.getElementById('batchParticipation').value,
                progressItems: Array.from(document.querySelectorAll('[name="batchProgressItem[]"]')).map(input => input.value),
                strengths: document.getElementById('batchStrengths').value,
                growth: document.getElementById('batchGrowth').value,
                comments: document.getElementById('batchComments').value,
                certificateText: document.getElementById('certificateText').value
            };
            
            // Add reports for each student
            studentNames.forEach(name => {
                const studentData = {...commonData};
                studentData.studentName = name.trim();
                savedReports.push(studentData);
            });
            
            localStorage.setItem('rillcodSavedReports', JSON.stringify(savedReports));
            updateSavedReportsList();
            alert(`Added ${studentNames.length} student reports to batch.`);
            
            // Clear the batch form
            document.getElementById('batchStudentNames').value = '';
        });
        
        // Update saved reports list display
        function updateSavedReportsList() {
            const list = document.getElementById('savedReportsList');
            list.innerHTML = '';
            
            if (savedReports.length === 0) {
                list.innerHTML = '<div style="padding: 10px; text-align: center; color: #666;">No reports saved yet</div>';
                selectedReports = [];
                return;
            }
            
            savedReports.forEach((report, index) => {
                const reportDiv = document.createElement('div');
                reportDiv.className = 'saved-report';
                if (selectedReports.includes(report)) {
                    reportDiv.classList.add('selected');
                }
                reportDiv.innerHTML = `
                    <span>${report.studentName || 'Unnamed Student'}</span>
                    <button onclick="removeSavedReport(${index})" style="background: none; border: none; color: #ff4444; cursor: pointer;">×</button>
                `;
                
                reportDiv.addEventListener('click', function(e) {
                    if (e.target.tagName !== 'BUTTON') {
                        this.classList.toggle('selected');
                        if (this.classList.contains('selected')) {
                            if (!selectedReports.includes(report)) {
                                selectedReports.push(report);
                            }
                        } else {
                            selectedReports = selectedReports.filter(r => r !== report);
                        }
                    }
                });
                
                list.appendChild(reportDiv);
            });
        }
        
        // Remove a saved report
        function removeSavedReport(index) {
            const removedReport = savedReports[index];
            savedReports.splice(index, 1);
            selectedReports = selectedReports.filter(r => r !== removedReport);
            localStorage.setItem('rillcodSavedReports', JSON.stringify(savedReports));
            updateSavedReportsList();
        }
        
        // Print reports one by one
        function printReportsSequentially(index) {
            if (index >= savedReports.length) {
                alert('All reports printed successfully!');
                return;
            }
            
            const reportData = savedReports[index];
            generateReportPDF(reportData, () => {
                printReportsSequentially(index + 1);
            });
        }
        
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(`${this.dataset.tab}-tab`).classList.add('active');
            });
        });
        
        // Enhanced course content generator with detailed descriptions
        const courseContentGenerator = {
            getDescription: function(topic, language) {
                const descriptions = {
                    "python": {
                        "variables": "Understanding variable declaration, assignment, naming conventions, and scope",
                        "data types": "Working with integers, floats, strings, booleans, and type conversion",
                        "operators": "Using arithmetic, comparison, logical, and assignment operators",
                        "conditionals": "Implementing if/elif/else statements and logical conditions",
                        "loops": "Using while and for loops with proper control flow and iteration",
                        "functions": "Creating functions with parameters, return values, and understanding scope",
                        "lists": "Working with list creation, indexing, slicing, and common methods",
                        "dictionaries": "Understanding key-value pairs and common dictionary operations",
                        "tuples": "Working with immutable sequences and tuple operations",
                        "sets": "Understanding unique element collections and set operations",
                        "file handling": "Reading from and writing to files with proper file modes",
                        "oop": "Basic understanding of classes, objects, inheritance, and polymorphism",
                        "modules": "Importing and using standard library and custom modules",
                        "exceptions": "Handling errors and exceptions with try/except blocks",
                        "debugging": "Identifying and fixing syntax errors and logical bugs",
                        "comments": "Writing effective code comments and documentation",
                        "strings": "String manipulation methods and formatting techniques",
                        "input/output": "Using input() and print() functions effectively",
                        "type conversion": "Converting between different data types explicitly",
                        "algorithm": "Understanding basic algorithm design and implementation"
                    },
                    "javascript": {
                        "variables": "Understanding var, let, const declarations and hoisting",
                        "data types": "Working with primitives and objects in JavaScript",
                        "functions": "Function declarations, expressions, arrow functions, and closures",
                        "objects": "Object literals, properties, methods, and prototypes",
                        "arrays": "Array methods and functional programming with arrays",
                        "dom manipulation": "Selecting and modifying DOM elements",
                        "events": "Event handling and propagation",
                        "async": "Callbacks, promises, and async/await",
                        "es6+": "Template literals, destructuring, spread/rest operators"
                    },
                    "html": {
                        "structure": "HTML document structure and semantic elements",
                        "forms": "Creating and validating forms",
                        "tables": "Creating accessible data tables",
                        "semantics": "Using semantic HTML5 elements",
                        "multimedia": "Embedding images, audio and video",
                        "accessibility": "Writing accessible HTML"
                    },
                    "css": {
                        "selectors": "CSS selectors and specificity",
                        "box model": "Understanding margin, border, padding, content",
                        "layout": "Flexbox, Grid and positioning",
                        "responsive": "Media queries and responsive design",
                        "animations": "CSS transitions and animations",
                        "variables": "CSS custom properties"
                    },
                    "java": {
                        "variables": "Primitive types and object references",
                        "classes": "Class structure and object instantiation",
                        "inheritance": "Extending classes and polymorphism",
                        "interfaces": "Implementing interfaces",
                        "collections": "Lists, Sets, Maps and their implementations",
                        "exceptions": "Exception handling with try-catch"
                    },
                    "csharp": {
                        "variables": "Value types vs reference types",
                        "classes": "Class members and access modifiers",
                        "linq": "Language Integrated Query syntax",
                        "delegates": "Delegates and lambda expressions",
                        "async": "Async/await pattern"
                    }
                };
                
                // Try to find description for the specific language first
                if (language && descriptions[language]) {
                    for (const [key, desc] of Object.entries(descriptions[language])) {
                        if (topic.toLowerCase().includes(key) || key.includes(topic.toLowerCase())) {
                            return `${topic.charAt(0).toUpperCase() + topic.slice(1)}: ${desc}`;
                        }
                    }
                }
                
                // Fall back to general programming concepts if not found
                const generalDescriptions = {
                    "variables": "Understanding variable declaration and usage",
                    "functions": "Creating reusable blocks of code",
                    "loops": "Repeating code execution",
                    "conditionals": "Making decisions in code",
                    "objects": "Working with object-oriented concepts",
                    "arrays": "Storing and manipulating collections of data",
                    "debugging": "Identifying and fixing errors in code"
                };
                
                for (const [key, desc] of Object.entries(generalDescriptions)) {
                    if (topic.toLowerCase().includes(key) || key.includes(topic.toLowerCase())) {
                        return `${topic.charAt(0).toUpperCase() + topic.slice(1)}: ${desc}`;
                    }
                }
                
                // Default description if no match found
                return `${topic}: Demonstrated understanding of ${topic.toLowerCase()} concepts`;
            },
            
            generateFromTopics: function(topics, language) {
                return topics.map(topic => {
                    const trimmedTopic = topic.trim();
                    if (!trimmedTopic) return null;
                    return this.getDescription(trimmedTopic, language);
                }).filter(item => item !== null);
            },
            
            getPresetTopics: function(preset) {
                const presets = {
                    "python": [
                        "Variables and Data Types",
                        "Operators and Expressions",
                        "Conditional Statements",
                        "Loops (while/for)",
                        "Functions and Scope",
                        "Lists and Tuples",
                        "Dictionaries and Sets",
                        "File Handling",
                        "Object-Oriented Programming",
                        "Error Handling"
                    ],
                    "web": [
                        "HTML Structure",
                        "CSS Styling",
                        "JavaScript Basics",
                        "DOM Manipulation",
                        "Responsive Design",
                        "Forms and Validation",
                        "Async Programming",
                        "Browser APIs"
                    ],
                    "oop": [
                        "Classes and Objects",
                        "Inheritance",
                        "Polymorphism",
                        "Encapsulation",
                        "Abstraction",
                        "Interfaces",
                        "Design Patterns"
                    ],
                    "javascript": [
                        "Variables and Scope",
                        "Functions and Closures",
                        "Objects and Prototypes",
                        "Arrays and Iteration",
                        "DOM Manipulation",
                        "Events",
                        "Async Programming",
                        "ES6+ Features"
                    ],
                    "html": [
                        "Document Structure",
                        "Semantic Elements",
                        "Forms and Inputs",
                        "Tables",
                        "Multimedia",
                        "Accessibility"
                    ],
                    "css": [
                        "Selectors and Specificity",
                        "Box Model",
                        "Layout (Flexbox/Grid)",
                        "Responsive Design",
                        "Transitions and Animations",
                        "CSS Variables"
                    ]
                };
                
                return presets[preset] || [];
            }
        };
    
        // Add progress item
        function addProgressItem() {
            const container = document.getElementById('progressItems');
            const newItem = document.createElement('div');
            newItem.className = 'progress-item';
            newItem.innerHTML = `
                <input type="text" name="progressItem[]" placeholder="Progress item (e.g., Variables & Data Types)" required>
                <button type="button" class="remove-item-btn" onclick="removeProgressItem(this)">×</button>
            `;
            container.appendChild(newItem);
        }
        
        // Add batch progress item
        function addBatchProgressItem() {
            const container = document.getElementById('batchProgressItems');
            const newItem = document.createElement('div');
            newItem.className = 'progress-item';
            newItem.innerHTML = `
                <input type="text" name="batchProgressItem[]" placeholder="Progress item (e.g., Variables & Data Types)">
                <button type="button" class="remove-item-btn" onclick="removeBatchProgressItem(this)">×</button>
            `;
            container.appendChild(newItem);
        }
        
        // Remove progress item
        function removeProgressItem(button) {
            const items = document.querySelectorAll('#progressItems .progress-item');
            if (items.length > 1) {
                button.parentElement.remove();
            } else {
                alert("You need at least one progress item.");
            }
        }
        
        // Remove batch progress item
        function removeBatchProgressItem(button) {
            const items = document.querySelectorAll('#batchProgressItems .progress-item');
            if (items.length > 1) {
                button.parentElement.remove();
            } else {
                alert("You need at least one progress item.");
            }
        }
        
        // Show strength options
        function showStrengthOptions() {
            document.getElementById('strengthOptions').classList.toggle('hidden');
            document.getElementById('growthOptions').classList.add('hidden');
            document.getElementById('commentOptions').classList.add('hidden');
        }
        
        // Show batch strength options
        function showBatchStrengthOptions() {
            document.getElementById('batchStrengthOptions').classList.toggle('hidden');
            document.getElementById('batchGrowthOptions').classList.add('hidden');
            document.getElementById('batchCommentOptions').classList.add('hidden');
        }
        
        // Select strength
        function selectStrength(strength) {
            document.getElementById('strengths').value = strength;
            document.getElementById('strengthOptions').classList.add('hidden');
        }
        
        // Select batch strength
        function selectBatchStrength(strength) {
            document.getElementById('batchStrengths').value = strength;
            document.getElementById('batchStrengthOptions').classList.add('hidden');
        }
        
        // Show growth options
        function showGrowthOptions() {
            document.getElementById('growthOptions').classList.toggle('hidden');
            document.getElementById('strengthOptions').classList.add('hidden');
            document.getElementById('commentOptions').classList.add('hidden');
        }
        
        // Show batch growth options
        function showBatchGrowthOptions() {
            document.getElementById('batchGrowthOptions').classList.toggle('hidden');
            document.getElementById('batchStrengthOptions').classList.add('hidden');
            document.getElementById('batchCommentOptions').classList.add('hidden');
        }
        
        // Select growth area
        function selectGrowth(growth) {
            document.getElementById('growth').value = growth;
            document.getElementById('growthOptions').classList.add('hidden');
        }
        
        // Select batch growth area
        function selectBatchGrowth(growth) {
            document.getElementById('batchGrowth').value = growth;
            document.getElementById('batchGrowthOptions').classList.add('hidden');
        }
        
        // Show comment options
        function showCommentOptions() {
            document.getElementById('commentOptions').classList.toggle('hidden');
            document.getElementById('strengthOptions').classList.add('hidden');
            document.getElementById('growthOptions').classList.add('hidden');
        }
        
        // Show batch comment options
        function showBatchCommentOptions() {
            document.getElementById('batchCommentOptions').classList.toggle('hidden');
            document.getElementById('batchStrengthOptions').classList.add('hidden');
            document.getElementById('batchGrowthOptions').classList.add('hidden');
        }
        
        // Select comment
        function selectComment(comment) {
            document.getElementById('comments').value = comment;
            document.getElementById('commentOptions').classList.add('hidden');
        }
        
        // Select batch comment
        function selectBatchComment(comment) {
            document.getElementById('batchComments').value = comment;
            document.getElementById('batchCommentOptions').classList.add('hidden');
        }
        
        // Generate progress items from topics
        document.getElementById('generateProgressBtn').addEventListener('click', function() {
            const topicsInput = document.getElementById('moduleTopics').value;
            if (!topicsInput.trim()) {
                alert("Please enter some topics first");
                return;
            }
            
            // Determine selected languages
            const selectedLanguages = [];
            if (document.getElementById('preset-python').checked) selectedLanguages.push('python');
            if (document.getElementById('preset-javascript').checked) selectedLanguages.push('javascript');
            if (document.getElementById('preset-html').checked) selectedLanguages.push('html');
            if (document.getElementById('preset-css').checked) selectedLanguages.push('css');
            if (document.getElementById('preset-java').checked) selectedLanguages.push('java');
            if (document.getElementById('preset-csharp').checked) selectedLanguages.push('csharp');
            
            const btn = this;
            const originalText = btn.textContent;
            btn.innerHTML = 'Generating... <span class="loading"></span>';
            btn.disabled = true;
            
            // Split topics by comma and clean them up
            const topics = topicsInput.split(',')
                .map(topic => topic.trim())
                .filter(topic => topic.length > 0);
            
            // Generate progress items for each language
            let generatedItems = [];
            if (selectedLanguages.length > 0) {
                selectedLanguages.forEach(lang => {
                    generatedItems = generatedItems.concat(courseContentGenerator.generateFromTopics(topics, lang));
                });
            } else {
                // If no language selected, use general descriptions
                generatedItems = courseContentGenerator.generateFromTopics(topics);
            }
            
            // Update the UI with generated items
            const progressItemsContainer = document.getElementById('progressItems');
            
            // Clear existing items except the first one
            while (progressItemsContainer.children.length > 1) {
                progressItemsContainer.removeChild(progressItemsContainer.lastChild);
            }
            
            // Update first item
            const firstInput = progressItemsContainer.querySelector('input');
            firstInput.value = generatedItems[0] || "Enter progress item";
            
            // Add remaining items
            for (let i = 1; i < generatedItems.length; i++) {
                const newItem = document.createElement('div');
                newItem.className = 'progress-item';
                newItem.innerHTML = `
                    <input type="text" name="progressItem[]" value="${generatedItems[i]}" required>
                    <button type="button" class="remove-item-btn" onclick="removeProgressItem(this)">×</button>
                `;
                progressItemsContainer.appendChild(newItem);
            }
            
            // If no items were generated (shouldn't happen), ensure at least one exists
            if (generatedItems.length === 0) {
                const firstInput = progressItemsContainer.querySelector('input');
                firstInput.value = "Enter progress item";
            }
            
            btn.textContent = originalText;
            btn.disabled = false;
        });
        
        // Handle preset buttons
        document.querySelectorAll('.progress-preset-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const preset = this.dataset.preset;
                const topics = courseContentGenerator.getPresetTopics(preset);
                document.getElementById('moduleTopics').value = topics.join(', ');
            });
        });
        
        // Generate batch progress items from topics
        document.getElementById('batchGenerateProgressBtn').addEventListener('click', function() {
            const topicsInput = document.getElementById('batchModuleTopics').value;
            if (!topicsInput.trim()) {
                alert("Please enter some topics first");
                return;
            }
            
            // Determine selected languages
            const selectedLanguages = [];
            if (document.getElementById('preset-python').checked) selectedLanguages.push('python');
            if (document.getElementById('preset-javascript').checked) selectedLanguages.push('javascript');
            if (document.getElementById('preset-html').checked) selectedLanguages.push('html');
            if (document.getElementById('preset-css').checked) selectedLanguages.push('css');
            if (document.getElementById('preset-java').checked) selectedLanguages.push('java');
            if (document.getElementById('preset-csharp').checked) selectedLanguages.push('csharp');
            
            const btn = this;
            const originalText = btn.textContent;
            btn.innerHTML = 'Generating... <span class="loading"></span>';
            btn.disabled = true;
            
            // Split topics by comma and clean them up
            const topics = topicsInput.split(',')
                .map(topic => topic.trim())
                .filter(topic => topic.length > 0);
            
            // Generate progress items for each language
            let generatedItems = [];
            if (selectedLanguages.length > 0) {
                selectedLanguages.forEach(lang => {
                    generatedItems = generatedItems.concat(courseContentGenerator.generateFromTopics(topics, lang));
                });
            } else {
                // If no language selected, use general descriptions
                generatedItems = courseContentGenerator.generateFromTopics(topics);
            }
            
            // Update the UI with generated items
            const progressItemsContainer = document.getElementById('batchProgressItems');
            
            // Clear existing items except the first one
            while (progressItemsContainer.children.length > 1) {
                progressItemsContainer.removeChild(progressItemsContainer.lastChild);
            }
            
            // Update first item
            const firstInput = progressItemsContainer.querySelector('input');
            firstInput.value = generatedItems[0] || "Enter progress item";
            
            // Add remaining items
            for (let i = 1; i < generatedItems.length; i++) {
                const newItem = document.createElement('div');
                newItem.className = 'progress-item';
                newItem.innerHTML = `
                    <input type="text" name="batchProgressItem[]" value="${generatedItems[i]}">
                    <button type="button" class="remove-item-btn" onclick="removeBatchProgressItem(this)">×</button>
                `;
                progressItemsContainer.appendChild(newItem);
            }
            
            // If no items were generated (shouldn't happen), ensure at least one exists
            if (generatedItems.length === 0) {
                const firstInput = progressItemsContainer.querySelector('input');
                firstInput.value = "Enter progress item";
            }
            
            btn.textContent = originalText;
            btn.disabled = false;
        });
        
        // Handle form submission
        document.getElementById('scoreForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            // Get all progress items
            data.progressItems = Array.from(document.querySelectorAll('[name="progressItem[]"]')).map(input => input.value);
            
            generateReportPDF(data);
        });
        
        function calculateGrade(score) {
            if (score >= 90) return 'A';
            if (score >= 80) return 'B';
            if (score >= 70) return 'C';
            if (score >= 60) return 'D';
            return 'F';
        }
        
        function updateChart(theoryScore, practicalScore, attendance) {
            if (performanceChart) {
                performanceChart.destroy();
            }
            
            performanceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Theory Test', 'Practical Test', 'Attendance'],
                    datasets: [{
                        label: 'Score (%)',
                        data: [theoryScore, practicalScore, attendance],
                        backgroundColor: [
                            'rgba(0, 0, 128, 0.7)',
                            'rgba(128, 0, 0, 0.7)',
                            'rgba(0, 128, 0, 0.7)'
                        ],
                        borderColor: [
                            'rgba(0, 0, 128, 1)',
                            'rgba(128, 0, 0, 1)',
                            'rgba(0, 128, 0, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Percentage Score'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Performance Metrics',
                            font: {
                                size: 14
                            }
                        }
                    }
                }
            });
        }
        
        function generatePDF(studentName = 'Student', callback) {
            const reportElement = document.getElementById('reportContent');
            
            // Use html2canvas with improved options for better PDF rendering
            html2canvas(reportElement, {
                scale: 2,
                logging: false,
                useCORS: true,
                allowTaint: true,
                windowWidth: reportElement.scrollWidth,
                windowHeight: reportElement.scrollHeight,
                scrollX: 0,
                scrollY: 0,
                backgroundColor: '#FFFFFF'
            }).then(canvas => {
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgData = canvas.toDataURL('image/png', 1.0);
                
                // Calculate image dimensions to fit the page
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const imgWidth = pageWidth - 20; // Add margins
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                // Center the image on the page with proper positioning
                const x = (pageWidth - imgWidth) / 2;
                const y = 5; // Reduced top margin
                
                // Ensure the content fits on the page
                if (imgHeight + y > pageHeight) {
                    // Scale down to fit if needed
                    const scale = (pageHeight - y - 10) / imgHeight;
                    pdf.addImage(imgData, 'PNG', x, y, imgWidth * scale, imgHeight * scale);
                } else {
                    pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
                }
                
                // Save the PDF
                const fileName = `RillCod_Progress_Report_${studentName.replace(/\s+/g, '_')}.pdf`;
                pdf.save(fileName);
                
                if (callback) callback();
            });
        }
        
        // Load settings when page loads
        window.addEventListener('load', loadSettings);
    </script>
</body>
</html>
